let q=-1;const m=t=>{addEventListener("pageshow",e=>{e.persisted&&(q=e.timeStamp,t(e))},!0)},u=(t,e,i,n)=>{let r,o;return s=>{e.value>=0&&(s||n)&&(o=e.value-(r??0),(o||r===void 0)&&(r=e.value,e.delta=o,e.rating=((a,d)=>a>d[1]?"poor":a>d[0]?"needs-improvement":"good")(e.value,i),t(e)))}},P=t=>{requestAnimationFrame(()=>requestAnimationFrame(()=>t()))},A=()=>{const t=performance.getEntriesByType("navigation")[0];if(t&&t.responseStart>0&&t.responseStart<performance.now())return t},g=()=>A()?.activationStart??0,l=(t,e=-1)=>{const i=A();let n="navigate";return q>=0?n="back-forward-cache":i&&(document.prerendering||g()>0?n="prerender":document.wasDiscarded?n="restore":i.type&&(n=i.type.replace(/_/g,"-"))),{name:t,value:e,rating:"good",delta:0,entries:[],id:`v5-${Date.now()}-${Math.floor(8999999999999*Math.random())+1e12}`,navigationType:n}},w=new WeakMap;function S(t,e){return w.get(t)||w.set(t,new e),w.get(t)}class W{t;i=0;o=[];h(e){if(e.hadRecentInput)return;const i=this.o[0],n=this.o.at(-1);this.i&&i&&n&&e.startTime-n.startTime<1e3&&e.startTime-i.startTime<5e3?(this.i+=e.value,this.o.push(e)):(this.i=e.value,this.o=[e]),this.t?.(e)}}const f=(t,e,i={})=>{try{if(PerformanceObserver.supportedEntryTypes.includes(t)){const n=new PerformanceObserver(r=>{Promise.resolve().then(()=>{e(r.getEntries())})});return n.observe({type:t,buffered:!0,...i}),n}}catch{}},M=t=>{let e=!1;return()=>{e||(t(),e=!0)}};let p=-1;const $=new Set,I=()=>document.visibilityState!=="hidden"||document.prerendering?1/0:0,C=t=>{if(document.visibilityState==="hidden"){if(t.type==="visibilitychange")for(const e of $)e();isFinite(p)||(p=t.type==="visibilitychange"?t.timeStamp:0,removeEventListener("prerenderingchange",C,!0))}},y=()=>{if(p<0){const t=g();p=(document.prerendering?void 0:globalThis.performance.getEntriesByType("visibility-state").filter(i=>i.name==="hidden"&&i.startTime>t)[0]?.startTime)??I(),addEventListener("visibilitychange",C,!0),addEventListener("prerenderingchange",C,!0),m(()=>{setTimeout(()=>{p=I()})})}return{get firstHiddenTime(){return p},onHidden(t){$.add(t)}}},T=t=>{document.prerendering?addEventListener("prerenderingchange",()=>t(),!0):t()},_=[1800,3e3],G=(t,e={})=>{T(()=>{const i=y();let n,r=l("FCP");const o=f("paint",s=>{for(const a of s)a.name==="first-contentful-paint"&&(o.disconnect(),a.startTime<i.firstHiddenTime&&(r.value=Math.max(a.startTime-g(),0),r.entries.push(a),n(!0)))});o&&(n=u(t,r,_,e.reportAllChanges),m(s=>{r=l("FCP"),n=u(t,r,_,e.reportAllChanges),P(()=>{r.value=performance.now()-s.timeStamp,n(!0)})}))})},k=[.1,.25],j=(t,e={})=>{const i=y();G(M(()=>{let n,r=l("CLS",0);const o=S(e,W),s=d=>{for(const c of d)o.h(c);o.i>r.value&&(r.value=o.i,r.entries=o.o,n())},a=f("layout-shift",s);a&&(n=u(t,r,k,e.reportAllChanges),i.onHidden(()=>{s(a.takeRecords()),n(!0)}),m(()=>{o.i=0,r=l("CLS",0),n=u(t,r,k,e.reportAllChanges),P(()=>n())}),setTimeout(n))}))};let N=0,b=1/0,v=0;const J=t=>{for(const e of t)e.interactionId&&(b=Math.min(b,e.interactionId),v=Math.max(v,e.interactionId),N=v?(v-b)/7+1:0)};let E;const F=()=>E?N:performance.interactionCount??0,K=()=>{"interactionCount"in performance||E||(E=f("event",J,{type:"event",buffered:!0,durationThreshold:0}))};let H=0;class U{u=[];l=new Map;m;p;v(){H=F(),this.u.length=0,this.l.clear()}L(){const e=Math.min(this.u.length-1,Math.floor((F()-H)/50));return this.u[e]}h(e){if(this.m?.(e),!e.interactionId&&e.entryType!=="first-input")return;const i=this.u.at(-1);let n=this.l.get(e.interactionId);if(n||this.u.length<10||e.duration>i.P){if(n?e.duration>n.P?(n.entries=[e],n.P=e.duration):e.duration===n.P&&e.startTime===n.entries[0].startTime&&n.entries.push(e):(n={id:e.interactionId,entries:[e],P:e.duration},this.l.set(n.id,n),this.u.push(n)),this.u.sort((r,o)=>o.P-r.P),this.u.length>10){const r=this.u.splice(10);for(const o of r)this.l.delete(o.id)}this.p?.(n)}}}const O=t=>{const e=globalThis.requestIdleCallback||setTimeout;document.visibilityState==="hidden"?t():(t=M(t),addEventListener("visibilitychange",t,{once:!0,capture:!0}),e(()=>{t(),removeEventListener("visibilitychange",t,{capture:!0})}))},x=[200,500],V=(t,e={})=>{if(!globalThis.PerformanceEventTiming||!("interactionId"in PerformanceEventTiming.prototype))return;const i=y();T(()=>{K();let n,r=l("INP");const o=S(e,U),s=d=>{O(()=>{for(const h of d)o.h(h);const c=o.L();c&&c.P!==r.value&&(r.value=c.P,r.entries=c.entries,n())})},a=f("event",s,{durationThreshold:e.durationThreshold??40});n=u(t,r,x,e.reportAllChanges),a&&(a.observe({type:"first-input",buffered:!0}),i.onHidden(()=>{s(a.takeRecords()),n(!0)}),m(()=>{o.v(),r=l("INP"),n=u(t,r,x,e.reportAllChanges)}))})};class z{m;h(e){this.m?.(e)}}const B=[2500,4e3],Q=(t,e={})=>{T(()=>{const i=y();let n,r=l("LCP");const o=S(e,z),s=d=>{e.reportAllChanges||(d=d.slice(-1));for(const c of d)o.h(c),c.startTime<i.firstHiddenTime&&(r.value=Math.max(c.startTime-g(),0),r.entries=[c],n())},a=f("largest-contentful-paint",s);if(a){n=u(t,r,B,e.reportAllChanges);const d=M(()=>{s(a.takeRecords()),a.disconnect(),n(!0)}),c=h=>{h.isTrusted&&(O(d),removeEventListener(h.type,c,{capture:!0}))};for(const h of["keydown","click","visibilitychange"])addEventListener(h,c,{capture:!0});m(h=>{r=l("LCP"),n=u(t,r,B,e.reportAllChanges),P(()=>{r.value=performance.now()-h.timeStamp,n(!0)})})}})},D=[800,1800],L=t=>{document.prerendering?T(()=>L(t)):document.readyState!=="complete"?addEventListener("load",()=>L(t),!0):setTimeout(t)},X=(t,e={})=>{let i=l("TTFB"),n=u(t,i,D,e.reportAllChanges);L(()=>{const r=A();r&&(i.value=Math.max(r.responseStart-g(),0),i.entries=[r],n(!0),m(()=>{i=l("TTFB",0),n=u(t,i,D,e.reportAllChanges),n(!0)}))})},R="G-STG8DWJ76K",Y=()=>{if(typeof window>"u")return;const t=document.createElement("script");t.src=`https://www.googletagmanager.com/gtag/js?id=${R}`,t.async=!0,document.head.appendChild(t),window.dataLayer=window.dataLayer||[];function e(){window.dataLayer.push(arguments)}window.gtag=e,e("js",new Date),e("config",R,{transport_type:"beacon",debug_mode:!1});function i(n){const{name:r,delta:o,id:s,value:a}=n;e("event",r,{event_category:"Web Vitals",event_label:s,value:Math.round(r==="CLS"?o*1e3:o),non_interaction:!0,metric_value:a,metric_delta:o})}j(i),Q(i),G(i),X(i),V(i)},Z=(t,e={})=>{typeof window<"u"&&window.gtag?window.gtag("event",t,e):console.log("[Analytics] Event:",t,e)};export{Y as i,Z as t};
